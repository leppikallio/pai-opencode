{{!--
  TEST_CASE Template — eval dataset and expected-contract definition
--}}

# {{test_suite.name}}

{{#if test_suite.version}}
**Version:** {{test_suite.version}}
{{/if}}
{{#if test_suite.description}}
{{test_suite.description}}
{{/if}}

{{#if test_suite.target_prompt}}
**Target Prompt:** `{{test_suite.target_prompt}}`
{{/if}}

---

## Test Cases ({{test_cases.length}} total)

{{#each test_cases}}
### {{id}} — {{name}}

{{#if category}}**Category:** `{{category}}`{{/if}}
{{#if difficulty}}  
**Difficulty:** {{difficulty}}{{/if}}
{{#if metadata.tags}}  
**Tags:** {{join metadata.tags ", "}}{{/if}}

#### Input

{{#if input.variables}}
**Variables:**
```yaml
{{#each input.variables}}
{{@key}}: {{this}}
{{/each}}
```
{{/if}}

**Content:**
```
{{input.content}}
```

#### Expected Contract

{{#if expected.output}}
**Golden Output:**
```
{{expected.output}}
```
{{/if}}

{{#if expected.must_contain}}
**Must contain:**
{{#each expected.must_contain}}
- `{{this}}`
{{/each}}
{{/if}}

{{#if expected.must_not_contain}}
**Must NOT contain:**
{{#each expected.must_not_contain}}
- `{{this}}`
{{/each}}
{{/if}}

{{#if expected.format}}
**Expected format:** {{expected.format}}
{{/if}}

{{#if metadata.notes}}
**Notes:** {{metadata.notes}}
{{/if}}

---
{{/each}}

## Suite-level Evaluation Rules

1. Run all test cases with identical environment/settings.
2. Preserve raw model outputs before judge scoring.
3. Judge against expected contract (not style preference unless specified).
4. Store pass/fail + reason for every failed case.

Matching semantics defaults:
- `must_contain`: case-insensitive substring match unless test metadata overrides.
- `must_not_contain`: case-insensitive substring match unless overridden.
- `expected.format`: structural requirement (e.g., JSON/markdown) must pass before content checks.

---

## Summary

| Metric | Value |
|---|---|
| Total Test Cases | {{test_cases.length}} |

{{#if test_suite.notes}}
---

## Notes
{{test_suite.notes}}
{{/if}}
